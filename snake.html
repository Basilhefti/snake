<html>
<!--
Copyright (C) 2014-2015 by Simon and Basil Hefti. All rights reserved.
The copyright to the computer program(s) herein is the property of
Simon and Basil Hefti, Switzerland. The program(s) may be used and/or copied
only with the written permission of Simon and Basil Hefti or in accordance
with the terms and conditions stipulated in the agreement/contract
under which the program(s) have been supplied.

This work is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
either express or implied, including, without limitation, any warranties or conditions
of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. -->

<html lang="en">
<head>
<title>Snake Game v1.0</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script src="js/jquery-2.1.3.min.js"></script>
<script src="js/jwerty.js"></script>
<script src="js/motivation.js"></script>
<script src="js/snake.js"></script>

<style type="text/css">
div, p, body, input, button, .ctrl {
	font-family: Arial;
	font-size: 10pt;
}
.ctrl {
	width: 100px;
}
</style>
</head>
<body>
	<div>Welcome. Start game with start button or key 'g'. Left: 'a', Right: 'd'. Up: 'w', Down: 's', as usual.</div>
	<div>Start game with start button or key 'g'. Restart with faster paste: '1'. Slower: '2'.</div>
	<div id="canvas_ctrl">
		<label for="width">Width</label>
		<input id="width" type="range" min="20" max="50" step="2" value="40" list="width_ticks"></input>
		<datalist id="width_ticks">
			<option>20</option>
			<option>30</option>
			<option>40</option>
			<option>50</option>
		</datalist>		
		<label for="height">Height</label>
		<input id="height" type="range" min="10" max="70" step="2" value="20" list="height_ticks"></input>
		<datalist id="height_ticks">
			<option>10</option>
			<option>30</option>
			<option>50</option>
			<option>70</option>
		</datalist>		
		<label for="speed">Speed</label>
		<input id="speed" type="range" min="10" max="310" step="20" value="100" list="speed_ticks"></input>
		<datalist id="speed_ticks">
			<option>10</option>
			<option>110</option>
			<option>210</option>
			<option>310</option>
		</datalist>		
		<button id="btnStart">Start</button>
	</div>

	<canvas id="snakearea" width="410" height="210"></canvas>

	<div id="game_ctrl">
		<button class="ctrl" id="btnLeft">Turn Left</button>
		<button class="ctrl" id="btnRight">Turn Right</button>
	</div>
<script>

var width = 40;
var height = 20;
var speed = 100;
var timerid = -1;

var game = new Game("snakearea",width, height, 10);

function up() {
	game.up();
}
function down() {
	game.down();
}
function left() {
	game.left();
}
function right() {
	game.right();
}

function turnRight() {
	game.turnRight();
}

function turnLeft() {
	game.turnLeft();
}

jwerty.key('p', function () {
	turnRight();
}, this, "body");

jwerty.key('o', function () {
	turnLeft();
}, this, "body");

jwerty.key('w', function () {
	up();
}, this, "body");

jwerty.key('a', function () {
	left();
}, this, "body");

jwerty.key('d', function () {
	right();
}, this, "body");

jwerty.key('s', function () {
	down();
}, this, "body");

jwerty.key('g', function () {
	start();
}, this, "body");

jwerty.key('space', function () {
	start();
}, this, "body");

jwerty.key('1', function () {
	if( speed <= 10) {
		// ignore
	} else {
		speed -= 20;
		$('#speed').val(speed);
	}
	start();
}, this, "body");

jwerty.key('2', function () {
	if( speed > 310) {
		// ignore
	} else {
		speed += 20;
		$('#speed').val(speed);
	}
	start();
}, this, "body");

function step() {
    game.step()
};
function start() {
	if( -1 != timerid ) {
		window.clearInterval(timerid);
	}
	game = new Game("snakearea",width, height, 10);
	timerid = window.setInterval(step,speed);
}

$('#width').on('change', function(e) {
	width = parseInt($(this).val());
	$('#snakearea').remove();
	var cw = (width + 1) * 10;
	var ch = (height + 1) * 10;
	var newCanvas = $('<canvas id="snakearea" width="' + cw + '" height="' + ch + '"/>');
	$('#canvas_ctrl').after(newCanvas);
});

$('#height').on('change', function(e) {
	height = parseInt($(this).val());
	$('#snakearea').remove();
	var cw = (width + 1) * 10;
	var ch = (height + 1) * 10;
	var newCanvas = $('<canvas id="snakearea" width="' + cw + '" height="' + ch + '"/>');
	$('#canvas_ctrl').after(newCanvas);
});

$('#speed').on('change', function(e) {
	speed = parseInt($(this).val());
});

$('#btnStart').on('click', function(e) {
	start();
});

$('#btnLeft').on('click', function(e) {
	turnLeft();
});
$('#btnRight').on('click', function(e) {
	turnRight();
});

</script>
<body>
</body>	
</html>